<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kei Nie 2541685, Felix Huang 2517419, Yunqing Chen 2585468, Jackson Fang 2432239">

<title>Workforce vs.&nbsp;Output: Tracing Income Convergence Paths Across Five Economies</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="350FinalQuarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="350FinalQuarto_files/libs/quarto-html/quarto.js"></script>
<script src="350FinalQuarto_files/libs/quarto-html/popper.min.js"></script>
<script src="350FinalQuarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="350FinalQuarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="350FinalQuarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="350FinalQuarto_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="350FinalQuarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="350FinalQuarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="350FinalQuarto_files/libs/bootstrap/bootstrap-973236bd072d72a04ee9cd82dcc9cb29.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Workforce vs.&nbsp;Output: Tracing Income Convergence Paths Across Five Economies</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Kei Nie 2541685, Felix Huang 2517419, Yunqing Chen 2585468, Jackson Fang 2432239 </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Economic development hinges on two broad engines of per-capita income growth: expanding labor inputs and boosting productivity. We would like to ask: How do countries at different stages of development deploy labor-force participation versus productivity improvements to drive real income gains? Examining five economies—Canada, China, the United Kingdom, Japan, and the United States—from 1990 to 2023, we find three distinct patterns. First, high-income North American and UK economies achieve substantial living-standards with only modest changes in employment rates. Second, China’s catch-up has depended first on rapidly mobilizing labor and later on transitioning toward productivity‐led growth. Third, Japan now struggles with stagnation in both dimensions. Strong negative correlations between GDP per capita and both employment and GDP growth suggest that wealthier countries derive less of their income gains from simply expanding the workforce or overall growth rates. Meanwhile, the strong positive association between employment and growth indicates that increases in labor participation tend to coincide with faster output expansion. Together these patterns trace a development path that moves from relying on labor quantity to elevating productivity per worker.</p>
</section>
<section id="data-description" class="level1">
<h1>Data Description</h1>
<section id="introduction-of-dataset-and-context" class="level3">
<h3 class="anchored" data-anchor-id="introduction-of-dataset-and-context">Introduction of Dataset and Context</h3>
<p>The study draws on a World-Bank panel that tracks four economies—Canada, the United States, China and Japan—from 1990 through 2023. Each country-year record combines three harmonised indicators downloaded on 15 April 2025 from the World Development Indicators: real GDP per capita in constant-2015 dollars, its annual growth rate and the employment-to-population ratio for adults aged 15 plus.</p>
</section>
<section id="data-cleaning-merging-and-preprocessing" class="level3">
<h3 class="anchored" data-anchor-id="data-cleaning-merging-and-preprocessing">Data cleaning, merging, and preprocessing</h3>
</section>
<section id="summary-of-key-variables" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-key-variables">Summary of Key Variables</h3>
<div id="90e111c8" class="cell" data-message="false" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>     Country Name  GDP_count      GDP_mean      GDP_std       GDP_min  \
0          Canada         34  39357.078405  4856.836357  30563.378820   
1           China         34   5073.229508  3583.630683    905.032457   
2           Japan         34  32770.738504  2371.821778  28422.213120   
3  United Kingdom         34  40583.327987  5456.617589  30441.481350   
4   United States         34  51521.551093  7640.364126  38637.839810   

       GDP_max  Employment_count  Employment_mean  Employment_std  \
0  45227.14474                33        60.712303        1.629455   
1  12175.19611                33        69.123242        4.132756   
2  36990.33011                33        59.238939        1.957756   
3  47551.22966                33        57.831939        1.511241   
4  65875.17788                33        60.468424        1.872493   

   Employment_min  Employment_max  GDP_Growth_count  GDP_Growth_mean  \
0          57.548          63.041                34         2.135410   
1          62.523          76.840                34         8.797740   
2          56.440          62.608                34         0.963596   
3          54.713          60.335                34         1.859416   
4          56.598          63.506                34         2.491121   

   GDP_Growth_std  GDP_Growth_min  GDP_Growth_max  
0        2.185206       -5.038233        5.286957  
1        2.924949        2.238638       14.230861  
2        2.050458       -5.693236        4.840929  
3        2.990588      -10.296919        8.575951  
4        1.757601       -2.576500        6.055053  </code></pre>
</div>
</div>
</section>
</section>
<section id="data-analysis" class="level1">
<h1>Data Analysis</h1>
<section id="income-levels-and-their-growth-paths-income-levels-and-their-growth-paths" class="level3">
<h3 class="anchored" data-anchor-id="income-levels-and-their-growth-paths-income-levels-and-their-growth-paths">Income levels and their growth paths Income levels and their growth paths</h3>
<div id="d72b2ad7" class="cell" data-fig-height="4" data-fig-width="6" data-message="false" data-execution_count="3">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="350FinalQuarto_files/figure-html/cell-4-output-1.png" class="quarto-figure quarto-figure-center figure-img" data-fig-pos="H" width="949" height="469"></p>
</figure>
</div>
</div>
</div>
<p>Real income in the United States rises from roughly $39 000 in 1990 to about $66 000 in 2023, widening its lead over all other cases. Canada mirrors the American path but remains $7 000–$10 000 lower throughout. The United Kingdom follows a similar trajectory, climbing from around $31 000 to nearly $47 000 over this period, tracking North America closely but persistently lagging by a few thousand dollars, with a pronounced dip around the 2009 global financial crisis and a smaller setback in 2020. China, starting from just over $1 000, multiplies its income almost ten-fold, yet still reaches only about $12 000 by the end of the sample. Japan’s income climbs during the 1990s but plateaus at approximately $36 000 after 2010. Corresponding growth-rate figures reveal that China’s rapid expansion, once firmly in double digits, decelerates to mid-single-digit territory in the 2010s. Japan’s growth oscillates around zero, reflecting its long struggle with deflation and demographic ageing. The United States, Canada, and the UK exhibit more moderate booms and busts—rarely exceeding 4 percent on the upside or falling much below 2 percent, except in the global crises of 2009 and 2020, which strike all five economies simultaneously.</p>
</section>
<section id="evolution-of-labor-market-participation" class="level3">
<h3 class="anchored" data-anchor-id="evolution-of-labor-market-participation">Evolution of labor-market participation</h3>
<div id="05882202" class="cell" data-fig-height="5" data-fig-width="8" data-message="false" data-execution_count="4">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="350FinalQuarto_files/figure-html/cell-5-output-1.png" class="quarto-figure quarto-figure-center figure-img" data-fig-pos="H" width="949" height="469"></p>
</figure>
</div>
</div>
</div>
<p>The employment-to-population chart reveals markedly different trajectories across these economies. China begins the 1990s with an exceptionally high participation rate of about 77 percent, but this figure declines steadily to the mid-60s by 2023. Japan starts near 63 percent, drifts downward for a decade, then partially recovers but never regains its early-1990s peak. The United Kingdom’s rate is lower, around 56 percent in 1990, dips slightly in the mid-1990s, then climbs gradually into the high-50s by the mid-2000s, before falling back below 56 percent during the 2009 recession and then recovering toward 60 percent by 2020; a pandemic-induced drop in 2020 is followed by a rebound to roughly 59 percent by 2023. Canada and the United States instead fluctuate within a relatively narrow band between 58 and 64 percent. Both North American economies share two conspicuous dips, which are the Great Recession in 2008 and the COVID-19 shock in 2020, yet by 2023 they have largely returned to pre-pandemic levels of around 62–63 percent.</p>
</section>
<section id="gdp-growth-of-countries" class="level2">
<h2 class="anchored" data-anchor-id="gdp-growth-of-countries">GDP Growth of Countries</h2>
<div id="67519c7c" class="cell" data-fig-height="4" data-fig-width="6" data-message="false" data-execution_count="5">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="350FinalQuarto_files/figure-html/cell-6-output-1.png" class="quarto-figure quarto-figure-center figure-img" data-fig-pos="H" width="877" height="435"></p>
</figure>
</div>
</div>
</div>
<p>Each panel shows annual real-GDP growth for one country. China starts with exceptional double-digit gains, slows steadily after 2010, and dips sharply in 2020. Canada, the United Kingdom, and the United States share the usual rich-economy cycle: steady 2–4 percent growth interrupted by recessions in 2009 and 2020, with quick rebounds. In the UK’s case, growth hovers around 2–3 percent through the 1990s and 2000s, dips slightly below zero in the global financial crisis, recovers modestly before the 2020 shock, then snaps back above 5 percent in 2021. Japan hovers near zero for most of the period, illustrating prolonged stagnation, and sees the same two global downturns. The shaded bands mark wider volatility during those recessions and during China’s early boom, but remain narrow in normal years，signaling more predictable growth paths then.</p>
</section>
<section id="indicators-correlation" class="level2">
<h2 class="anchored" data-anchor-id="indicators-correlation">Indicators’ Correlation</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>GDP</th>
<th>Employment</th>
<th>GDP Growth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GDP</td>
<td>1.0</td>
<td>-0.72</td>
<td>-0.65</td>
</tr>
<tr class="even">
<td>Employment</td>
<td>-0.72</td>
<td>1.0</td>
<td>0.75</td>
</tr>
<tr class="odd">
<td>GDP Growth</td>
<td>-0.65</td>
<td>0.75</td>
<td>1.0</td>
</tr>
</tbody>
</table>
<p>The correlation matrix reveals a clear trade-off between output levels and both labor participation and growth momentum. GDP per capita is strongly negatively correlated with the employment-to-population ratio (–0.72), indicating that higher-income economies tend to rely more on productivity gains than on expanding their workforce. Likewise, GDP per capita exhibits a sizeable negative relationship with GDP growth (–0.65), reflecting the convergence pattern whereby lower-income countries grow faster as they catch up. By contrast, employment share and GDP growth move strongly in tandem (+0.75), suggesting that when economies do expand rapidly, they often do so by mobilizing additional labor. Together, these coefficients underscore how the balance between labor input and productivity shifts as countries develop.</p>
</section>
</section>
<section id="result-and-discussion" class="level1">
<h1>Result and discussion</h1>
<section id="result" class="level3">
<h3 class="anchored" data-anchor-id="result">Result</h3>
<p>Between 1990 and 2023, per-capita incomes diverged sharply across the five economies. The United States rose from $39 000 to $66 000, Canada from $32 000 to $55 000, and the United Kingdom from $31 000 to $47 000—each maintaining a stable employment-to-population rate in the high-50s to low-60s. China’s income surged nearly ten-fold (from $1 000 to $12 000) even as its participation rate fell from 77 percent to the mid-60s. Japan climbed to $36 000 by 2010 but then stagnated alongside a roughly constant 56 percent participation rate. Annual GDP growth showed China’s double-digit booms tapering to mid-single digits after 2010 and a sharp 2020 contraction; advanced economies exhibited 2–4 percent “business-as-usual” growth with synchronized dips in 2009 and 2020. The correlation matrix quantifies these patterns: GDP per capita correlates –0.72 with employment and –0.65 with growth, while employment and growth correlate +0.75.</p>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<p>These patterns highlight three development paths. Advanced economies (U.S., Canada, U.K.) raise living standards mostly through productivity gains rather than by expanding their workforce. China’s catch-up unfolded in two stages: first mobilizing vast numbers of workers, then shifting toward higher output per worker. Japan now faces stagnation in both income growth and labor participation, held back by an ageing population and years of low demand. However, national averages mask regional and sectoral differences, and strong correlations do not prove causation—factors like investment, technology adoption, and policy changes also play crucial roles. Major events (China’s WTO entry, Japan’s “lost decades,” the pandemic) further complicate the simple trend picture.</p>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Achieving and sustaining higher living standards requires a clear shift in how economies grow. Early on, many countries rely on bringing more workers into the labor force. Over time, however, simply adding heads is no longer enough—boosting what each worker produces becomes the main driver of income gains. Our findings show that advanced economies have already made this transition, but they now confront challenges from ageing populations and slower productivity growth. Emerging economies, such as China, are in the middle of this journey: moving from labor-intensive expansion toward a greater emphasis on skills, innovation, and capital investment.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>